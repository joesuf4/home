# Edit this file to introduce tasks to be run by cron.
#
# Each task to run has to be defined through a single line
# indicating with different fields when the task will be run
# and what command to run for the task
#
# To define the time you can provide concrete values for
# minute (m), hour (h), day of month (dom), month (mon),
# and day of week (dow) or use '*' in these fields (for 'any').
#
# Notice that tasks will be started based on the cron's system
# daemon's notion of time and timezones.
#
# Output of the crontab jobs (including errors) is sent through
# email to the user the crontab file belongs to (unless redirected).
#
# For example, you can run a backup of all your user accounts
# at 5 a.m every week with:
# 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/
#
# For more information see the manual pages of crontab(5) and cron(8)

SHELL=/usr/bin/zsh
HOME=/home/schaefj
USER=schaefj
TERM=xterm-256color
OP_AWS="BX AWS"
BCS_BATCH=4

# m h  dom mon dow   command

30 10 * * 1 sleep 300 | zsh -ic "for ctx in staging prod; do bcs assume-role apps-\$ctx-deprecated engineer; for c in bx-apps-\$ctx bx-apps-\$ctx-dmz; do eks update-kubeconfig \$c datadog; eks batch datadog '[' '\$(ls /proc/1/fd | wc -l)' -gt 10000 ']' '&&' echo kill 1 '&&' kill 1; done; done"
30 10 * * 2 sleep 300 | zsh -ic "for org in corporate-finance-prod corporate-finance-nonprod treasury-nonprod user-feeds-nonprod niagara-nonprod niagara-prod bx-websites-nonprod bx-websites-prod hr-nonprod hr-prod; do bcs assume-role \$org engineer; eks update-kubeconfig \$(eks list-clusters | head -n 1) datadog; eks batch datadog '[' '\$(ls /proc/1/fd | wc -l)' -gt 10000 ']' '&&' echo kill 1 '&&' kill 1; done"
30 10 * * 3 sleep 300 | zsh -ic 'seed_vault_pass && sbei && ec2 batch . "timedatectl | grep -qF \"synchronized: no\" && sudo apt-get install ntpdate && sudo ntpdate 169.254.169.123" 2>/dev/null'
30 10 * * 4 sleep 300 | ~/bin/log4j-scanner-user.sh
30 10 * * 5 sleep 300 | zsh -ic "eks report global . -n 1000; bcs clear-envs; PLACEHOLDER= report_node_inventory_static > ~winhome/tmp/eks-ec2-node-inventory-cost-report-\$(date -Iseconds).tsv"
